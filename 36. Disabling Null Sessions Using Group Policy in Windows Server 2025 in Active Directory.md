# ğŸ” Disabling Null Sessions Using Group Policy in Windows Server 2025 in Active Directory

### ğŸ›¡ï¸ Security Hardening Guide

---

## ğŸ“˜ Overview

In enterprise Windows environments, reducing the attack surface is a fundamental security requirement. One frequently overlooked risk is **anonymous (null session) access**, which allows unauthenticated users to retrieve sensitive system and domain information.

Although Windows Server 2025 includes stronger default security controls, **explicit enforcement via Group Policy** remains a best practiceâ€”especially in domain-joined environments where consistency and compliance are critical.

This repository documents:

* ğŸ” What null sessions are
* âš ï¸ Why they pose a security risk
* ğŸ§© How to disable them centrally using Group Policy
* ğŸ“‹ Recommended best practices for production environments

---

## â“ What Is a Null Session?

A **null session** is an anonymous connection to a Windows system using **SMB (Server Message Block)** or **RPC (Remote Procedure Call)** without providing valid credentials.

Historically, null sessions allowed unauthenticated users to enumerate:

* ğŸ‘¤ Local and domain user accounts
* ğŸ‘¥ Group memberships
* ğŸ“ Network shares
* ğŸ§  Security policies and domain structure

While originally intended for legacy compatibility, null sessions represent a **serious security vulnerability** when enabled.

---

## âš ï¸ Security Impact of Anonymous Enumeration

Anonymous enumeration provides attackers with valuable reconnaissance data that can be used to:

* ğŸ¯ Identify valid usernames for password spraying
* ğŸ”“ Discover sensitive or misconfigured network shares
* ğŸ—ºï¸ Map Active Directory structure and trust relationships
* ğŸš¨ Facilitate privilege escalation and lateral movement

From a security perspective, **any unauthenticated access to identity or resource information violates the principle of least privilege**.

---

## ğŸš« Why Disable Null Sessions in Windows Server 2025

Even though modern Windows versions restrict many anonymous access features by default, security frameworks and Microsoft baselines strongly recommend **explicit configuration**.

Disabling null sessions via Group Policy allows organizations to:

* ğŸ” Block anonymous access to the Security Account Manager (SAM)
* ğŸ§± Prevent unauthenticated enumeration of users and shares
* ğŸ§© Enforce consistent security controls across all domain-joined systems
* ğŸ“œ Align with Zero Trust and Microsoft Security Baseline recommendations

---

## ğŸ› ï¸ Group Policy Configuration

### âœ… Prerequisites

* ğŸ–¥ï¸ Windows Server 2025 Domain Controller
* ğŸ“¦ Group Policy Management Console (GPMC)
* ğŸ”‘ Permissions to create or modify GPOs

---

### ğŸ§­ Step 1: Create or Edit a Group Policy Object

1. Open **Group Policy Management**
2. Create a new GPO (recommended) or edit an existing one
3. Link the GPO to the appropriate **Domain or OU**

---

### ğŸ“‚ Step 2: Navigate to Security Options

```
Computer Configuration
 â””â”€ Policies
  â””â”€ Windows Settings
      â””â”€ Security Settings
         â””â”€ Local Policies
            â””â”€ Security Options
```

---

### âš™ï¸ Step 3: Configure Required Policies

Apply the following settings:

| ğŸ”§ Policy Name                                                                | âœ… Recommended Setting |
| ----------------------------------------------------------------------------- | --------------------- |
| Network access: Do not allow anonymous enumeration of SAM accounts and shares | **Disabled**           |
| Network access: Do not allow anonymous enumeration of SAM accounts            | **Enabled**           |
| Network access: Restrict anonymous access to Named Pipes and Shares           | **Enabled**           |
| Network access: Let Everyone permissions apply to anonymous users             | **Disabled**          |

These configurations ensure that **anonymous users cannot enumerate accounts, groups, or network resources**.

---

### ğŸ”„ Step 4: Apply the Policy

Force policy update if required:

```powershell
gpupdate /force
```

ğŸ” Reboot systems if prompted.

---

## ğŸ” Validation (Recommended)

After deployment:

* ğŸ§ª Verify policy application:

  ```powershell
  gpresult /r
  ```
* ğŸ“‘ Monitor **Security Event Logs** for authentication or access failures
* ğŸ§© Validate compatibility if legacy applications or devices are present

---

## â­ Best Practices

* ğŸ§ª Test changes in a **staging or pilot OU**
* ğŸ“ Document changes for **audit and compliance**
* ğŸ“˜ Review Microsoft Security Baselines regularly
* ğŸš« Avoid enabling anonymous access unless explicitly required and approved

---

## ğŸ“ Compliance & Security Alignment

This configuration supports alignment with:

* ğŸªŸ Microsoft Security Baselines
* ğŸ” Zero Trust Architecture
* ğŸ“Š CIS Benchmarks (Windows Server)
* ğŸ§¾ ISO/IEC 27001 Access Control principles

---

## ğŸ Conclusion

Disabling null sessions is a **low-effort, high-impact security hardening measure**.

By enforcing these settings through Group Policy in Windows Server 2025, organizations eliminate unnecessary anonymous access while maintaining centralized control and consistency.

> ğŸ§  **Strong security often starts by closing doors that should never have been open.**

---

## ğŸš€ Optional Enhancements

This repository can be extended to include:

* ğŸ§ª PowerShell validation scripts
* ğŸ“‹ Baseline compliance checklists
* ğŸ“ Audit evidence templates
* ğŸ§­ Security benchmark mappings

---
